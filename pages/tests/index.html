<!DOCTYPE html>
<html lang="uk">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Тестування</title>
    <style>
      /* Загальні стилі */
      body {
        font-family: "Orbitron", sans-serif;
        background: linear-gradient(135deg, #00c6ff 0%, #0072ff 100%);
        margin: 0;
        padding: 0;
        color: white;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        flex-direction: column;
      }

      /* Стилі для хедера */
      header {
        width: 100%;
        background: rgba(0, 0, 0, 0.6);
        padding: 20px 0;
        position: fixed;
        top: 0;
        z-index: 100;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
      }

      nav ul {
        list-style: none;
        padding: 0;
        margin: 0;
        display: flex;
        justify-content: center;
      }

      nav ul li {
        margin: 0 15px;
      }

      nav ul li a {
        color: white;
        text-decoration: none;
        font-weight: bold;
        transition: color 0.3s ease, transform 0.3s ease;
      }

      nav ul li a:hover {
        color: #00ffe7;
        text-shadow: 0 0 12px #00ffe7;
        transform: scale(1.1);
      }

      /* Стилі для основного контейнера */
      .main-container {
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        width: 100%;
        height: 100vh;
        padding-top: 80px; /* Відступ для хедера */
      }

      /* Стилі для тесту */
      #test-container {
        display: none;
        width: 80%; /* Збільшена ширина */
        max-width: 800px; /* Максимальна ширина */
        background: rgba(0, 0, 0, 0.4);
        padding: 40px;
        border-radius: 15px;
        box-shadow: 0px 10px 30px rgba(0, 0, 0, 0.5);
        animation: fadeInUp 1s ease-out;
        margin-bottom: 30px;
        text-align: center;
        height: 600px; /* Збільшена висота */
        overflow-y: auto; /* Прокрутка по вертикалі */
      }

      /* Стилі для питань */
      .question {
        margin-bottom: 20px;
        font-size: 1.7rem;
      }

      .question p {
        font-size: 1.3rem;
        font-weight: bold;
        color: #e0e0e0;
        text-shadow: 0 0 8px rgba(0, 0, 0, 0.4);
      }

      /* Стилі для варіантів відповідей */
      .question label {
        display: block;
        margin: 10px 0;
        font-size: 1rem;
        cursor: pointer;
        color: #00e5ff;
        transition: color 0.3s ease;
      }

      .question label:hover {
        color: #00ffe7;
        text-shadow: 0 0 8px #00ffe7;
      }

      /* Стилі для кнопки 'Next' */
      #next-button,
      #submit-button {
        padding: 12px 25px;
        background: linear-gradient(135deg, #ff6ec4, #7873f5);
        border: none;
        color: white;
        font-size: 1.2rem;
        border-radius: 10px;
        cursor: pointer;
        transition: transform 0.3s ease, background 0.3s ease;
        margin-top: 20px;
      }

      #next-button:hover,
      #submit-button:hover {
        transform: scale(1.1);
        background: linear-gradient(135deg, #ff9d76, #7873f5);
      }

      /* Стилі для результатів */
      #result-container {
        display: none;
        text-align: center;
        padding: 30px;
        background: rgba(0, 0, 0, 0.6);
        border-radius: 15px;
        box-shadow: 0px 15px 40px rgba(0, 0, 0, 0.6);
        width: 350px;
        margin-top: 30px;
        animation: fadeInUp 1s ease-out;
      }

      #result-container p {
        font-size: 1.8rem;
        color: #ffffff;
      }

      /* Анімація fadeInUp */
      @keyframes fadeInUp {
        0% {
          opacity: 0;
          transform: translateY(30px);
        }
        100% {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* Адаптивність для мобільних пристроїв */
      @media (max-width: 600px) {
        #test-container,
        #result-container {
          width: 90%;
        }

        #next-button,
        #submit-button {
          font-size: 1rem;
          padding: 10px 20px;
        }
      }
    </style>
  </head>
  <body>
    <header>
      <nav>
        <ul>
          <li><a href="./index.html">Головна</a></li>
          <li><a href=".././menu.html">Меню</a></li>
          <li><a href="../tests/index.html">Тести</a></li>
          <li><a href="../games.html">Ігри</a></li>
          <li><a href="./contacts.html">Контакти</a></li>
        </ul>
      </nav>
    </header>

    <div class="main-container">
      <div id="start-container">
        <button id="next-button" onclick="startTest()">Почати тест</button>
      </div>

      <div id="test-container">
        <form id="test-form">
          <div id="questions-container"></div>
          <button id="submit-button" type="button" onclick="submitTest()">
            Завершити тест
          </button>
        </form>
      </div>

      <div id="result-container">
        <p id="score"></p>
        <p id="discount"></p>
        <button id="next-button" onclick="location.reload()">
          Почати знову
        </button>
      </div>
    </div>

    <script>
      let questions = [];
      let correctAnswers = 0;

      // Завантаження питань з JSON
      async function loadTest() {
        try {
          const response = await fetch("questions.json");
          if (!response.ok) {
            throw new Error("Не вдалося завантажити питання");
          }
          const data = await response.json();
          questions = data.questions;

          const questionsContainer = document.getElementById(
            "questions-container"
          );
          questionsContainer.innerHTML = "";

          if (questions.length === 0) {
            console.log("Немає питань у JSON!");
          }

          questions.forEach((question, index) => {
            const questionElement = document.createElement("div");
            questionElement.classList.add("question");

            const questionTitle = document.createElement("p");
            questionTitle.textContent = `${index + 1}. ${question.питання}`;
            questionElement.appendChild(questionTitle);

            question.відповіді.forEach((answer, i) => {
              const answerElement = document.createElement("label");
              answerElement.innerHTML = ` 
                            <input type="radio" name="question${index}" value="${i}">
                            ${answer}
                        `;
              questionElement.appendChild(answerElement);
            });

            questionsContainer.appendChild(questionElement);
          });
        } catch (error) {
          console.error("Помилка при завантаженні питань:", error);
        }
      }

      function startTest() {
        document.querySelector("#start-container").style.display = "none";
        document.getElementById("test-container").style.display = "block";
        loadTest();
      }

      function submitTest() {
        correctAnswers = 0;
        const form = document.getElementById("test-form");
        const formData = new FormData(form);

        formData.forEach((value, key) => {
          const questionIndex = parseInt(key.replace("question", ""));
          const correctAnswerIndex =
            questions[questionIndex].правильна_відповідь;

          if (parseInt(value) === correctAnswerIndex) {
            correctAnswers++;
          }
        });

        // Вирахувати знижку
        const discount = Math.min(
          Math.floor((correctAnswers / questions.length) * 100),
          10
        );

        // Показати результат
        document.getElementById("test-container").style.display = "none";
        document.getElementById("result-container").style.display = "block";
        document.getElementById(
          "score"
        ).textContent = `Ваш результат: ${correctAnswers} з ${questions.length}`;
        document.getElementById(
          "discount"
        ).textContent = `Ваша знижка: ${discount}%`;
      }
    </script>
  </body>
</html>
